import{Aa as ve,B as w,Db as Se,E as u,F as g,Fa as H,Ga as Q,Ha as we,I as he,Ia as $,Ib as ye,Ja as D,K as B,Lb as ne,M as l,Mb as Me,N as x,Pb as U,Qb as A,R as h,S as c,U as d,V as a,W as k,X as v,Xa as Ce,Y as _,Z as m,b as se,ba as Z,ca as ee,d as le,da as te,db as P,e as ce,ea as s,eb as W,fa as E,fb as ie,ga as G,gb as I,ha as C,hb as be,ia as b,ib as q,j as pe,ja as S,jb as X,ka as y,kb as J,l as me,m as ue,ma as fe,nb as F,ob as V,p as K,qa as xe,ra as O,s as z,sa as L,t as ge,u as j,w as _e,y as Y,ya as M}from"./chunk-3SZQQZGF.js";import{a as ae,b as de}from"./chunk-2VMXMS7J.js";var Ae=(()=>{let r=class r{};r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=w({type:r,selectors:[["app-admin"]],standalone:!0,features:[y],decls:1,vars:0,template:function(e,i){e&1&&k(0,"router-outlet")},dependencies:[we]});let n=r;return n})();var T=(()=>{let r=class r{constructor(t,e){this.http=t,this.store=e,this.allWordsUrl=`${A.apiUrl}/admin/words`,this.baseDefinitionsUrl=`${A.apiUrl}/admin/definitions`,this.baseExamplesUrl=`${A.apiUrl}/admin/examples`,this.baseTranslationsUrl=`${A.apiUrl}/admin/translations`,this.saveWordUrl=`${A.apiUrl}/admin/words`,this.getAudioUrl=()=>`${A.apiUrl}/admin/text-to-speech`,this.getSaveDefinitionsUrl=i=>`${A.apiUrl}/admin/words/${i}/definitions`,this.getSaveExamplesUrl=i=>`${A.apiUrl}/admin/words/${i}/example`,this.getSaveTranslationsUrl=i=>`${A.apiUrl}/admin/words/${i}/translations`,this.updatePhrasePronunciationUrl=(i,p)=>`${A.apiUrl}/admin/dialogs/${i}/phrase/${p}/pronunciation`,this.getWordBreakdownUrl=i=>`${A.apiUrl}/admin/breakdown/${i}`,this.dialogsUrl=`${A.apiUrl}/admin/dialogs`,this.audioVoices=["Rachel","Drew","Clyde","Paul","Domi","Dave","Fin","Sarah","Antoni","Charlie","George","Elli","Callum","Patrick","Harry","Liam","Dorothy","Josh","Matilda","Michael","Gigi","Freya","Grace"]}getToken(){return this.store.selectSnapshot(Se.token)}updatePhrasePronunciation(t,e,i){return this.http.patch(this.updatePhrasePronunciationUrl(t,e),i,{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}getAllDialogs(){return this.http.get(this.dialogsUrl,{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}getAllWords(){return this.http.get(this.allWordsUrl,{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}getDefinitions(t){return this.http.get(`${this.baseDefinitionsUrl}/${t}`,{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}getExamples(t){return this.http.get(`${this.baseExamplesUrl}/${t}`,{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}getTranslations(t){return this.http.get(`${this.baseTranslationsUrl}/${t}`,{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}saveWord(t){return this.http.post(this.saveWordUrl,t,{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}getWordBreakDown(t){return this.http.get(this.getWordBreakdownUrl(t),{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}saveDefinitions(t,e){return this.http.post(this.getSaveDefinitionsUrl(t),{definitions:e},{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}saveTranslations(t,e){return this.http.post(this.getSaveTranslationsUrl(t),{translations:e},{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}saveExample(t,e){return this.http.post(this.getSaveExamplesUrl(t),e,{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}getAudioForPhrase(t,e){let i=e||Me(this.audioVoices),p=this.getAudioUrl(),f={text:t,voice:i};return this.http.post(p,f,{responseType:"blob",headers:new M({Accept:"audio/mpeg",Authorization:`Bearer ${this.getToken()}`})})}saveDialog(t){return this.http.post(this.dialogsUrl,{dialog:t},{headers:new M({Authorization:`Bearer ${this.getToken()}`})})}};r.\u0275fac=function(e){return new(e||r)(Y(ve),Y(Ce))},r.\u0275prov=_e({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();function Ie(n,r){if(n&1){let o=v();d(0,"div",4),_("click",function(){let e=u(o).$implicit,i=m();return g(i.selectClick(e))}),s(1),a()}if(n&2){let o=r.$implicit;l(),E(o.word)}}var ke=(()=>{let r=class r{constructor(t,e){this.adminService=t,this.router=e,this.wordList=[],this.search=""}ngOnInit(){this.adminService.getAllWords().subscribe({next:t=>this.wordList=t})}getWordData(){return this.wordList.filter(t=>t.word.includes(this.search))}selectClick(t){this.router.navigate([`admin/edit-word/${t.id}`])}addNewWord(){this.router.navigate(["admin/create-word"])}addNewDialog(){this.router.navigate(["admin/create-dialog"])}openDialogsList(){this.router.navigate(["admin/dialogs-list"])}};r.\u0275fac=function(e){return new(e||r)(x(T),x($))},r.\u0275cmp=w({type:r,selectors:[["app-admin-word-table"]],standalone:!0,features:[y],decls:12,vars:2,consts:[[1,"admin-word-table"],[1,"btn",3,"click"],["type","text",1,"admin-input-text",3,"ngModelChange","ngModel"],["class","word-list-data",3,"click",4,"ngFor","ngForOf"],[1,"word-list-data",3,"click"]],template:function(e,i){e&1&&(d(0,"div",0)(1,"div")(2,"button",1),_("click",function(){return i.addNewWord()}),s(3,"Add new word"),a(),d(4,"button",1),_("click",function(){return i.addNewDialog()}),s(5,"Add new dialog"),a(),d(6,"button",1),_("click",function(){return i.openDialogsList()}),s(7,"Open Dialogs List"),a()(),d(8,"div"),s(9," Search: "),d(10,"input",2),S("ngModelChange",function(f){return b(i.search,f)||(i.search=f),f}),a(),h(11,Ie,2,1,"div",3),a()()),e&2&&(l(10),C("ngModel",i.search),l(),c("ngForOf",i.getWordData()))},dependencies:[V,P,W,F,I,O],styles:[".admin-word-table[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{cursor:pointer;outline:0;display:inline-block;font-weight:400;line-height:1.5;text-align:center;background-color:transparent;border:1px solid #0d6efd;padding:6px 12px;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;color:#0d6efd}.admin-word-table[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.admin-word-table[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-word-table[_ngcontent-%COMP%]   .admin-input-text[_ngcontent-%COMP%]{line-height:1.5;border:1px solid #ccc;padding:7px 14px 9px;font-size:17px}.admin-word-table[_ngcontent-%COMP%]   .word-list-data[_ngcontent-%COMP%]{font-size:1.3em;margin:5px;padding:3px;border:1px solid grey;border-radius:5px}.admin-word-table[_ngcontent-%COMP%]   .word-list-data[_ngcontent-%COMP%]:hover{background-color:#e0ffff;cursor:pointer}"]});let n=r;return n})();var Ee=(()=>{let r=class r{constructor(t){this.route=t}ngOnInit(){console.log(this.route.snapshot.paramMap.get("id"))}};r.\u0275fac=function(e){return new(e||r)(x(Q))},r.\u0275cmp=w({type:r,selectors:[["app-admin-edit-word"]],standalone:!0,features:[y],decls:2,vars:0,template:function(e,i){e&1&&(d(0,"p"),s(1,"admin-edit-word works!"),a())}});let n=r;return n})();var Ve=["audioInput"],Ue=["dynamicElements"];function Ne(n,r){if(n&1&&(d(0,"audio",6),s(1,"AUDIO"),a()),n&2){let o=m(2);c("src",o.audioSrc,B)}}function Le(n,r){if(n&1){let o=v();d(0,"div")(1,"button",2),_("click",function(){u(o);let e=m();return g(e.getAudioForWord())}),s(2,"Get audio"),a(),h(3,Ne,2,1,"audio",5),a()}if(n&2){let o=m();l(3),c("ngIf",o.audioSrc)}}function $e(n,r){n&1&&(d(0,"span"),s(1,"Save word"),a())}function Be(n,r){n&1&&(d(0,"span"),s(1,"Saved!"),a())}function Re(n,r){if(n&1){let o=v();d(0,"div")(1,"button",7),_("click",function(){u(o);let e=m();return g(e.saveNewWord())}),h(2,$e,2,0,"span",4)(3,Be,2,0,"span",4),a()()}if(n&2){let o=m();l(),c("disabled",!o.audioSrc||!o.word.value||o.wordId),l(),c("ngIf",!o.wordId),l(),c("ngIf",o.wordId)}}function ze(n,r){if(n&1){let o=v();d(0,"div")(1,"input",11),S("ngModelChange",function(e){let i=u(o).$implicit;return b(i.translation,e)||(i.translation=e),g(e)}),a(),d(2,"select",12),S("ngModelChange",function(e){let i=u(o).$implicit;return b(i.language,e)||(i.language=e),g(e)}),d(3,"option"),s(4,"Russian"),a(),d(5,"option"),s(6,"Ukrainian"),a()(),d(7,"button",13),_("click",function(){let e=u(o).index,i=m(2);return g(i.delete("translations",e))}),s(8,"X"),a()()}if(n&2){let o=r.$implicit;l(),C("ngModel",o.translation),l(),C("ngModel",o.language)}}function je(n,r){if(n&1){let o=v();d(0,"div")(1,"input",11),S("ngModelChange",function(e){let i=u(o).$implicit;return b(i.definition,e)||(i.definition=e),g(e)}),a(),d(2,"button",13),_("click",function(){let e=u(o).index,i=m(2);return g(i.delete("definitions",e))}),s(3,"X"),a()()}if(n&2){let o=r.$implicit;l(),C("ngModel",o.definition)}}function Ge(n,r){if(n&1&&(d(0,"audio",6),s(1,"AUDIO"),a()),n&2){let o=m().index,t=m(2);c("src",t.examples[o].audioSrc,B)}}function He(n,r){if(n&1){let o=v();d(0,"button",9),_("click",function(){u(o);let e=m().index,i=m(2);return g(i.saveExample(e))}),s(1,"\u2713 "),a()}if(n&2){let o=m(3);c("disabled",!o.wordId)}}function Qe(n,r){if(n&1){let o=v();d(0,"div",14)(1,"textarea",15),S("ngModelChange",function(e){let i=u(o).$implicit;return b(i.example,e)||(i.example=e),g(e)}),_("select",function(e){let i=u(o).index,p=m(2);return g(p.selected(e,i))}),a(),d(2,"span",16),s(3),a(),d(4,"span",16),s(5),a(),d(6,"button",2),_("click",function(){let e=u(o).index,i=m(2);return g(i.getAudioForExample(e))}),s(7,"Get audio"),a(),h(8,Ge,2,1,"audio",5),d(9,"button",13),_("click",function(){let e=u(o).index,i=m(2);return g(i.delete("examples",e))}),s(10,"X"),a(),h(11,He,2,1,"button",17),a()}if(n&2){let o=r.$implicit,t=r.index,e=m(2);l(),C("ngModel",o.example),l(2),E(o.inclusionStart),l(2),E(o.inclusionEnd),l(3),c("ngIf",e.examples[t].audioSrc),l(3),c("ngIf",!e.examples[t].saved)}}function qe(n,r){if(n&1){let o=v();d(0,"div")(1,"h3"),s(2,"Translations"),a(),d(3,"button",2),_("click",function(){u(o);let e=m();return g(e.addNewTranslation())}),s(4,"New translation"),a(),h(5,ze,9,2,"div",8),d(6,"div")(7,"button",9),_("click",function(){u(o);let e=m();return g(e.saveTranslations())}),s(8,"\u2713 Save translations "),a()(),d(9,"h3"),s(10,"Definitions"),a(),d(11,"button",2),_("click",function(){u(o);let e=m();return g(e.addNewDefinition())}),s(12,"New definition"),a(),h(13,je,4,1,"div",8),d(14,"div")(15,"button",9),_("click",function(){u(o);let e=m();return g(e.saveDefinitions())}),s(16,"\u2713 Save definitions "),a()(),d(17,"h3"),s(18,"Examples"),a(),d(19,"button",2),_("click",function(){u(o);let e=m();return g(e.addNewExample())}),s(20,"New example"),a(),h(21,Qe,12,5,"div",10),a()}if(n&2){let o=m();l(5),c("ngForOf",o.translations),l(2),c("disabled",!o.wordId||!o.translations.length||o.translationsSaved),l(6),c("ngForOf",o.definitions),l(2),c("disabled",!o.wordId||!o.definitions.length||o.definitionsSaved),l(6),c("ngForOf",o.examples)}}var Oe=(()=>{let r=class r{constructor(t,e){this.adminService=t,this.sanitizer=e,this.word=new ie(""),this.language=new ie(""),this.audioSrc="",this.pronunciation=null,this.translationsSaved=!1,this.definitionsSaved=!1,this.definitions=[],this.examples=[],this.translations=[]}saveExample(t){let e=this.examples[t].audio;if(!e||!this.examples[t].inclusionEnd){console.error("NO AUDIO ATTACHED OR NO INCLUSION");return}let i=this.examples[t],p=new FormData;return p.append("file",e),p.append("example",i.example),p.append("inclusionStart",i.inclusionStart.toString()),p.append("inclusionEnd",i.inclusionEnd.toString()),this.adminService.saveExample(this.wordId,p).subscribe({next:()=>this.examples[t].saved=!0})}getAudioForWord(){this.adminService.getAudioForPhrase(this.word.value,"Daniel").subscribe(t=>{this.pronunciation=t;let e=window.URL.createObjectURL(t);this.audioSrc=this.sanitizer.bypassSecurityTrustUrl(e)})}getAudioForExample(t){let e=this.examples[t].example;this.adminService.getAudioForPhrase(e).subscribe(i=>{this.examples[t].audio=i;let p=window.URL.createObjectURL(i);this.examples[t].audioSrc=this.sanitizer.bypassSecurityTrustUrl(p)})}selected(t,e){this.examples[e].inclusionStart=t.target.selectionStart,this.examples[e].inclusionEnd=t.target.selectionEnd-1}addNewDefinition(){this.definitions.push({definition:""})}addNewExample(){this.examples.push({example:"",inclusionEnd:0,inclusionStart:0})}addNewTranslation(){this.translations.push({translation:"",language:"Russian"})}delete(t,e){this[t].splice(e,1)}saveNewWord(){let t=new FormData;return t.append("file",this.pronunciation),t.append("word",this.word.value.trim()),this.adminService.saveWord(t).pipe(j(e=>this.wordId=e.id)).pipe(z(()=>this.adminService.getWordBreakDown(this.word.value.trim()))).subscribe(({translations:e,definitions:i,examples:p})=>{this.addTranslationsFromBreakdown(e),this.addDefinitionsFromBreakdown(i),this.addExamplesFromBreakdown(p)})}addTranslationsFromBreakdown(t){t.forEach(e=>{this.translations.push({translation:e,language:"Russian"})})}addDefinitionsFromBreakdown(t){t.forEach(e=>{this.definitions.push({definition:e})})}addExamplesFromBreakdown(t){t.forEach(e=>{this.examples.push({example:e,inclusionEnd:0,inclusionStart:0})}),ue(500).pipe(ge(e=>e<this.examples.length)).subscribe(e=>this.getAudioForExample(e))}saveTranslations(){this.adminService.saveTranslations(this.wordId,this.translations).subscribe({next:()=>this.translationsSaved=!0})}saveDefinitions(){this.adminService.saveDefinitions(this.wordId,this.definitions).subscribe({next:()=>this.definitionsSaved=!0})}reset(){this.wordId=null,this.word.setValue(""),this.audioSrc="",this.pronunciation=null,this.translationsSaved=!1,this.definitionsSaved=!1,this.definitions=[],this.translations=[],this.examples=[]}};r.\u0275fac=function(e){return new(e||r)(x(T),x(H))},r.\u0275cmp=w({type:r,selectors:[["app-admin-create-word"]],viewQuery:function(e,i){if(e&1&&(Z(Ve,5),Z(Ue,5,he)),e&2){let p;ee(p=te())&&(i.audioInput=p.first),ee(p=te())&&(i.dynamicElements=p)}},standalone:!0,features:[y],decls:11,vars:4,consts:[[1,"admin-create-word"],["routerLink","/admin/word-table",1,"btn"],[1,"btn",3,"click"],["type","text",1,"admin-input-text",3,"formControl"],[4,"ngIf"],["controls","",3,"src",4,"ngIf"],["controls","",3,"src"],[1,"btn","green",3,"click","disabled"],[4,"ngFor","ngForOf"],[1,"btn","save-btn",3,"click","disabled"],["class","example-configuration",4,"ngFor","ngForOf"],["type","text",1,"admin-input-text","texts",3,"ngModelChange","ngModel"],[1,"admin-input-text",3,"ngModelChange","ngModel"],[1,"btn","delete-btn",3,"click"],[1,"example-configuration"],[1,"admin-input-text","texts",3,"ngModelChange","select","ngModel"],[1,"inclusion-span"],["class","btn save-btn",3,"disabled","click",4,"ngIf"]],template:function(e,i){e&1&&(d(0,"div",0)(1,"button",1),s(2,"Main Page"),a(),d(3,"button",2),_("click",function(){return i.reset()}),s(4,"RESET"),a(),d(5,"h3"),s(6,"Word"),a(),k(7,"input",3),h(8,Le,4,1,"div",4)(9,Re,4,3,"div",4)(10,qe,22,5,"div",4),a()),e&2&&(l(7),c("formControl",i.word),l(),c("ngIf",i.word.value),l(),c("ngIf",i.audioSrc),l(),c("ngIf",i.wordId))},dependencies:[D,L,V,X,J,P,q,W,be,O,F,I],styles:[".admin-create-word[_ngcontent-%COMP%]{overflow:scroll;height:100vh}.admin-create-word[_ngcontent-%COMP%]   .example-configuration[_ngcontent-%COMP%]{display:flex}.admin-create-word[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{cursor:pointer;outline:0;display:inline-block;font-weight:400;line-height:1.5;text-align:center;background-color:transparent;border:1px solid #0d6efd;padding:6px 12px;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;color:#0d6efd}.admin-create-word[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.admin-create-word[_ngcontent-%COMP%]   .btn.green[_ngcontent-%COMP%]{background-color:green;border:none}.admin-create-word[_ngcontent-%COMP%]   .btn.green[_ngcontent-%COMP%]{background-color:green;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .btn.green[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{background-color:#f6b0b0;color:#0d6efd}.admin-create-word[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{background-color:green;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .admin-input-text[_ngcontent-%COMP%]{line-height:1.5;border:1px solid #ccc;padding:7px 14px 9px;font-size:17px}.admin-create-word[_ngcontent-%COMP%]   .texts[_ngcontent-%COMP%]{width:60%}.admin-create-word[_ngcontent-%COMP%]   .inclusion-span[_ngcontent-%COMP%]{display:inline-block;border:1px solid grey;padding:5px;margin-right:10px;min-width:40px}"]});let n=r;return n})();var Xe=(n,r)=>({d_even:n,d_odd:r});function Je(n,r){if(n&1&&(d(0,"option"),s(1),a()),n&2){let o=r.$implicit;l(),E(o)}}function Ke(n,r){if(n&1&&(d(0,"option"),s(1),a()),n&2){let o=r.$implicit;l(),E(o)}}function Ye(n,r){if(n&1&&(d(0,"option",16),s(1),a()),n&2){let o=r.$implicit;c("value",o.id),l(),E(o.word)}}function Ze(n,r){if(n&1&&k(0,"audio",17),n&2){let o=m().index,t=m();c("src",t.audioData[o]==null?null:t.audioData[o].audioSrc,B)}}function et(n,r){if(n&1){let o=v();d(0,"div",8)(1,"textarea",9),S("ngModelChange",function(e){let i=u(o).$implicit;return b(i.phrase,e)||(i.phrase=e),g(e)}),_("select",function(e){let i=u(o).index,p=m();return g(p.selected(e,i))}),a(),d(2,"input",10),S("ngModelChange",function(e){let i=u(o).$implicit;return b(i.wordId,e)||(i.wordId=e),g(e)}),a(),d(3,"datalist",11),h(4,Ye,2,2,"option",12),a(),d(5,"span",13),s(6),a(),d(7,"span",13),s(8),a(),h(9,Ze,1,1,"audio",14),d(10,"span",15),_("click",function(){let e=u(o).index,i=m();return g(i.delete(e))}),s(11,"X"),a()()}if(n&2){let o=r.$implicit,t=r.index,e=m();l(),C("ngModel",o.phrase),c("ngClass",fe(7,Xe,t%2===0,t%2!==0)),l(),C("ngModel",o.wordId),l(2),c("ngForOf",e.wordList),l(2),E(o.inclusionStart),l(2),E(o.inclusionEnd),l(),c("ngIf",e.audioData[t]==null?null:e.audioData[t].audioSrc)}}var Te=(()=>{let r=class r{constructor(t,e){this.adminService=t,this.sanitizer=e,this.dialog=[],this.audioData=[],this.voices=this.adminService.audioVoices}ngOnInit(){this.adminService.getAllWords().subscribe({next:t=>this.wordList=t})}getAudios(){ce(this.dialog).pipe(K((t,e)=>me(3e3*e).pipe(pe(()=>this.adminService.getAudioForPhrase(t.phrase,e%2?this.secondSpeaker:this.firstSpeaker).pipe(j(i=>{this.audioData[e]={blob:i,audioSrc:this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(i))}})))))).subscribe(()=>{})}addNewDialogLine(){this.dialog.push({phrase:""})}delete(t){this.dialog.splice(t,1)}selected(t,e){this.dialog[e].inclusionStart=t.target.selectionStart,this.dialog[e].inclusionEnd=t.target.selectionEnd-1}isValid(){let t=this.dialog.filter(e=>e.phrase&&(!e.wordId&&!e.inclusionStart&&!e.inclusionEnd||e.wordId&&ne(e.inclusionStart)&&ne(e.inclusionEnd)));return this.dialog.length&&t.length===this.dialog.length}composeRequest(t,e){let i=new FormData;return i.append("file",this.audioData[e].blob),this.adminService.updatePhrasePronunciation(t.dialogId,t.id,i)}saveEverything(){if(this.dialog.length!==this.audioData.length){console.error("NOT ALL AUDIO ATTACHED");return}let t=this.dialog.map((e,i)=>{let p=de(ae({},e),{order:i,phrase:e.phrase.trim()});return e.wordId&&(p.wordId=Number(e.wordId)),p});return this.adminService.saveDialog(t).pipe(z(e=>le(e,se))).pipe(K((e,i)=>this.composeRequest(e,i))).subscribe({next:e=>{console.log("saved!"),this.dialog=[]},error:e=>{console.log(e),alert(e)}})}};r.\u0275fac=function(e){return new(e||r)(x(T),x(H))},r.\u0275cmp=w({type:r,selectors:[["app-admin-add-dialog"]],standalone:!0,features:[y],decls:22,vars:7,consts:[[1,"admin-create-dialog"],["routerLink","/admin/word-table",1,"btn"],[3,"ngModelChange","ngModel"],[4,"ngFor","ngForOf"],[1,"btn",3,"click"],[1,"create-dialog-container"],["class","dialog-phrase-config",4,"ngFor","ngForOf"],[1,"btn",3,"click","disabled"],[1,"dialog-phrase-config"],[1,"admin-input-text","texts",3,"ngModelChange","select","ngModel","ngClass"],["list","word-from-db",3,"ngModelChange","ngModel"],["id","word-from-db"],[3,"value",4,"ngFor","ngForOf"],[1,"inclusion-span"],["controls","",3,"src",4,"ngIf"],[1,"btn","delete-btn",3,"click"],[3,"value"],["controls","",3,"src"]],template:function(e,i){e&1&&(d(0,"div",0)(1,"button",1),s(2,"Main Page"),a(),d(3,"h3"),s(4,"Dialog"),a(),d(5,"h5"),s(6,"First speaker:"),a(),d(7,"select",2),S("ngModelChange",function(f){return b(i.firstSpeaker,f)||(i.firstSpeaker=f),f}),h(8,Je,2,1,"option",3),a(),d(9,"h5"),s(10,"Second speaker:"),a(),d(11,"select",2),S("ngModelChange",function(f){return b(i.secondSpeaker,f)||(i.secondSpeaker=f),f}),h(12,Ke,2,1,"option",3),a(),k(13,"hr"),d(14,"button",4),_("click",function(){return i.addNewDialogLine()}),s(15,"New phrase"),a(),d(16,"div",5),h(17,et,12,10,"div",6),a(),d(18,"button",7),_("click",function(){return i.getAudios()}),s(19,"Get audios "),a(),d(20,"button",7),_("click",function(){return i.saveEverything()}),s(21,"Save everything "),a()()),e&2&&(l(7),C("ngModel",i.firstSpeaker),l(),c("ngForOf",i.voices),l(3),C("ngModel",i.secondSpeaker),l(),c("ngForOf",i.voices),l(5),c("ngForOf",i.dialog),l(),c("disabled",!i.firstSpeaker||!i.secondSpeaker),l(2),c("disabled",!i.isValid()))},dependencies:[D,V,X,J,P,q,W,F,I,O,xe,L],styles:[".admin-create-dialog[_ngcontent-%COMP%]{margin:8px}.admin-create-dialog[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{background-color:#f6b0b0;color:#0d6efd}.admin-create-dialog[_ngcontent-%COMP%]   .dialog-phrase-config[_ngcontent-%COMP%]{display:flex}.admin-create-dialog[_ngcontent-%COMP%]   .create-dialog-container[_ngcontent-%COMP%]{overflow:scroll;max-height:70vh;margin:10px 0}.admin-create-dialog[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{cursor:pointer;outline:0;display:inline-block;font-weight:400;line-height:1.5;text-align:center;background-color:transparent;border:1px solid #0d6efd;padding:6px 12px;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;color:#0d6efd}.admin-create-dialog[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.admin-create-dialog[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-create-dialog[_ngcontent-%COMP%]   .admin-input-text[_ngcontent-%COMP%]{line-height:1.5;border:2px solid #ccc;padding:7px 14px 9px;font-size:17px;margin:2px 0}.admin-create-dialog[_ngcontent-%COMP%]   .texts[_ngcontent-%COMP%]{width:70%}.admin-create-dialog[_ngcontent-%COMP%]   .inclusion-span[_ngcontent-%COMP%]{display:inline-block;border:1px solid grey;padding:5px;margin-right:10px;min-width:40px}.admin-create-dialog[_ngcontent-%COMP%]   .d_even[_ngcontent-%COMP%]{border-color:red}.admin-create-dialog[_ngcontent-%COMP%]   .d_odd[_ngcontent-%COMP%]{border-color:green}"]});let n=r;return n})();function tt(n,r){if(n&1&&(d(0,"div")(1,"p")(2,"span"),s(3),a(),s(4," | "),d(5,"span"),s(6),a(),s(7," | "),d(8,"span"),s(9),a()()()),n&2){let o=r.$implicit;l(3),G("phrase: ",o.phrase,""),l(3),G("pronunciation: ",!!o.pronunciation,""),l(3),G("wordId: ",o.wordId,"")}}function it(n,r){if(n&1){let o=v();d(0,"div",2)(1,"button",3),_("click",function(){let e=u(o).$implicit,i=m();return g(i.editDialog(e))}),s(2,"Edit"),a(),h(3,tt,10,3,"div",4),k(4,"hr"),a()}if(n&2){let o=r.$implicit;l(3),c("ngForOf",o)}}var De=(()=>{let r=class r{constructor(t,e){this.adminService=t,this.router=e,this.dialogs=[]}ngOnInit(){this.adminService.getAllDialogs().subscribe({next:t=>{this.dialogs=ye(t),console.log(this.dialogs)}})}editDialog(t){this.router.navigate(["admin/edit-dialog"],{state:{data:t}})}};r.\u0275fac=function(e){return new(e||r)(x(T),x($))},r.\u0275cmp=w({type:r,selectors:[["app-dialogs-list"]],standalone:!0,features:[y],decls:4,vars:1,consts:[["routerLink","/admin/word-table",1,"btn"],["class","dialog",4,"ngFor","ngForOf"],[1,"dialog"],[3,"click"],[4,"ngFor","ngForOf"]],template:function(e,i){e&1&&(d(0,"div")(1,"button",0),s(2,"Main Page"),a(),h(3,it,5,1,"div",1),a()),e&2&&(l(3),c("ngForOf",i.dialogs))},dependencies:[D,O],styles:[".dialog[_ngcontent-%COMP%]:nth-child(odd){background-color:#b2c1f6}.dialog[_ngcontent-%COMP%]:nth-child(2n){background-color:#ecccf6}"]});let n=r;return n})();function nt(n,r){n&1&&k(0,"input",8)}function ot(n,r){if(n&1){let o=v();d(0,"button",9),_("click",function(){u(o);let e=m().index,i=m();return g(i.savePronunciation(e))}),s(1,"Save"),a()}}function rt(n,r){n&1&&(d(0,"audio",10),s(1,"AUDIO"),a())}function at(n,r){if(n&1){let o=v();d(0,"div",3)(1,"textarea",4),S("ngModelChange",function(e){let i=u(o).$implicit;return b(i.phrase,e)||(i.phrase=e),g(e)}),a(),h(2,nt,1,0,"input",5)(3,ot,2,0,"button",6)(4,rt,2,0,"audio",7),a()}if(n&2){let o=r.$implicit;l(),C("ngModel",o.phrase),l(),c("ngIf",!o.pronunciation),l(),c("ngIf",!o.pronunciation),l(),c("ngIf",o.pronunciation)}}var Pe=(()=>{let r=class r{constructor(t,e,i){this.route=t,this.router=e,this.adminService=i,this.dialog=[],this.route.paramMap.subscribe(p=>{let f=window.history.state.data;f||this.router.navigate(["admin/dialogs-list"]),this.dialog=f,console.log("data"),console.log(f)})}savePronunciation(t){let i=document.querySelectorAll(".phrase-audio")[t].files[0];if(!i){console.error("NO AUDIO ATTACHED");return}console.log(i);let p=new FormData;p.append("file",i);let f=this.dialog[0].dialogId,We=this.dialog[t].id;return this.adminService.updatePhrasePronunciation(f,We,p).subscribe()}};r.\u0275fac=function(e){return new(e||r)(x(Q),x($),x(T))},r.\u0275cmp=w({type:r,selectors:[["app-edit-dialog"]],standalone:!0,features:[y],decls:4,vars:1,consts:[["routerLink","/admin/word-table",1,"btn"],[1,"container-of-all"],["class","container-of-phrases",4,"ngFor","ngForOf"],[1,"container-of-phrases"],["rows","3",1,"phrase",3,"ngModelChange","ngModel"],["type","file","accept",".mp3","class","phrase-audio",4,"ngIf"],[3,"click",4,"ngIf"],["controls","",4,"ngIf"],["type","file","accept",".mp3",1,"phrase-audio"],[3,"click"],["controls",""]],template:function(e,i){e&1&&(d(0,"button",0),s(1,"Main Page"),a(),d(2,"div",1),h(3,at,5,4,"div",2),a()),e&2&&(l(3),c("ngForOf",i.dialog))},dependencies:[D,O,V,P,W,F,I,L],styles:[".container-of-phrases[_ngcontent-%COMP%]{display:flex;justify-items:center;align-items:center}.phrase[_ngcontent-%COMP%]{width:70vw;resize:none;margin-bottom:10px}"]});let n=r;return n})();var Kt=[{path:"",component:Ae,canActivate:[U],data:{adminOnly:!0},children:[{path:"",redirectTo:"word-table",pathMatch:"full"},{path:"word-table",canActivate:[U],data:{adminOnly:!0},component:ke},{path:"edit-word/:id",canActivate:[U],data:{adminOnly:!0},component:Ee},{path:"create-word",canActivate:[U],data:{adminOnly:!0},component:Oe},{path:"create-dialog",canActivate:[U],data:{adminOnly:!0},component:Te},{path:"dialogs-list",canActivate:[U],data:{adminOnly:!0},component:De},{path:"edit-dialog",canActivate:[U],data:{adminOnly:!0},component:Pe}]}];export{Kt as adminRoutes};
