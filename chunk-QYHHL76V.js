import{$ as p,B as w,Ba as C,C as z,Da as _e,E as u,F as g,Gb as ye,I as me,Ka as fe,L as K,Lb as G,N as l,O as x,Ob as ie,Pb as Se,Sb as V,T as f,Tb as b,U as m,W as d,Wa as he,X as a,Y as A,Z as h,_,b as ae,bb as D,cb as W,d as de,da as Z,db as ee,ea as Y,eb as P,fa as J,fb as xe,ga as s,gb as ve,ha as T,hb as R,ia as j,ib as X,ja as y,ka as S,la as M,lb as Ce,m as se,mb as we,na as pe,nb as q,ob as be,pb as F,qb as I,r as le,rb as te,sa as ue,ta as E,ua as B,v as ce,w as $,y as Q,ya as ge}from"./chunk-L5NJHCJF.js";import{a as oe,b as re}from"./chunk-4CLCTAJ7.js";var Me=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=w({type:i,selectors:[["app-admin"]],decls:1,vars:0,template:function(e,n){e&1&&A(0,"router-outlet")},dependencies:[be]});let o=i;return o})();var k=(()=>{let i=class i{constructor(t,e){this.http=t,this.store=e,this.allWordsUrl=`${b.apiUrl}/admin/words`,this.basePronunciationUrl=`${b.apiUrl}/admin/pronunciation`,this.baseDefinitionsUrl=`${b.apiUrl}/admin/definitions`,this.baseExamplesUrl=`${b.apiUrl}/admin/examples`,this.baseTranslationsUrl=`${b.apiUrl}/admin/translations`,this.saveWordUrl=`${b.apiUrl}/admin/words`,this.getAudioUrl=n=>`https://api.elevenlabs.io/v1/text-to-speech/${n}`,this.getSaveDefinitionsUrl=n=>`${b.apiUrl}/admin/words/${n}/definitions`,this.getSaveExamplesUrl=n=>`${b.apiUrl}/admin/words/${n}/example`,this.getSaveTranslationsUrl=n=>`${b.apiUrl}/admin/words/${n}/translations`,this.getSavePronunciationUrl=n=>`${b.apiUrl}/admin/words/${n}/pronunciation`,this.updatePhrasePronunciationUrl=(n,c)=>`${b.apiUrl}/admin/dialogs/${n}/phrase/${c}/pronunciation`,this.dialogsUrl=`${b.apiUrl}/admin/dialogs`,this.audioVoices={word:"onwK4e9ZLuTAKqWW03F9",Rachel:"21m00Tcm4TlvDq8ikWAM",Drew:"29vD33N1CtxCmqQRPOHJ",Clyde:"2EiwWnXFnvU5JabPnv8n",Paul:"5Q0t7uMcjvnagumLfvZi",Domi:"AZnzlk1XvdvUeBnXmlld",Dave:"CYw3kZ02Hs0563khs1Fj",Fin:"D38z5RcWu1voky8WS1ja",Sarah:"EXAVITQu4vr4xnSDxMaL",Antoni:"ErXwobaYiN019PkySvjV",Thomas:"GBv7mTt0atIp3Br8iCZE",Charlie:"IKne3meq5aSn9XLyUdCD",George:"JBFqnCBsd6RMkjVDRZzb",Emily:"LcfcDJNUP1GQjkzn1xUU",Elli:"MF3mGyEYCl7XYWbV9V6O",Callum:"N2lVS1w4EtoT3dr4eOWO",Patrick:"ODq5zmih8GrVes37Dizd",Harry:"SOYHLrjzK2X1ezoPC6cr",Liam:"TX3LPaxmHKxFdv7VOQHJ",Dorothy:"ThT5KcBeYPX3keUQqHPh",Josh:"TxGEqnHWrfWFTfGW9XjX",Matilda:"XrExE9yKIg1WjnnlVkGX",Michael:"flq6f7yk4E4fJM5XTYuZ",Ethan:"g5CIjZEefAph4nQFvHAz",Gigi:"jBpfuIE2acCO8z3wKNLl",Freya:"jsCqWAovK2LkecY7zXl4",Grace:"oWAxZDx7w5VEj9dCyTzz"},this.audioModelId="eleven_multilingual_v2"}getToken(){return this.store.selectSnapshot(ye.token)}updatePhrasePronunciation(t,e,n){return this.http.patch(this.updatePhrasePronunciationUrl(t,e),n,{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}getAllDialogs(){return this.http.get(this.dialogsUrl,{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}getAllWords(){return this.http.get(this.allWordsUrl,{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}getWordById(t){return this.http.get(`${this.allWordsUrl}/${t}?include=Translation&include=Example&include=Definition`,{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}getPronunciation(t){return this.http.get(`${this.basePronunciationUrl}/${t}`,{headers:new C({Authorization:`Bearer ${this.getToken()}`}),responseType:"arraybuffer"})}getDefinitions(t){return this.http.get(`${this.baseDefinitionsUrl}/${t}`,{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}getExamples(t){return this.http.get(`${this.baseExamplesUrl}/${t}`,{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}getTranslations(t){return this.http.get(`${this.baseTranslationsUrl}/${t}`,{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}saveWord(t){return this.http.post(this.saveWordUrl,t,{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}saveDefinitions(t,e){return this.http.post(this.getSaveDefinitionsUrl(t),{definitions:e},{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}saveTranslations(t,e){return this.http.post(this.getSaveTranslationsUrl(t),{translations:e},{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}saveExample(t,e){return this.http.post(this.getSaveExamplesUrl(t),e,{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}getAudioForPhrase(t,e=!1){let n=e?Se(G(this.audioVoices)):this.audioVoices.word,c=this.getAudioUrl(n),v={text:t,model_id:this.audioModelId};return this.http.post(c,v,{responseType:"blob",headers:new C({Accept:"audio/mpeg","Content-Type":"application/json","xi-api-key":"877030f988b65342aa6ad0eaccc49b7d"})})}saveDialog(t){return this.http.post(this.dialogsUrl,{dialog:t},{headers:new C({Authorization:`Bearer ${this.getToken()}`})})}};i.\u0275fac=function(e){return new(e||i)(Q(_e),Q(he))},i.\u0275prov=ce({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();function Pe(o,i){if(o&1){let r=h();d(0,"div",4),_("click",function(){let e=u(r).$implicit,n=p();return g(n.selectClick(e))}),s(1),a()}if(o&2){let r=i.$implicit;l(),T(r.word)}}var Ae=(()=>{let i=class i{constructor(t,e){this.adminService=t,this.router=e,this.wordList=[],this.search=""}ngOnInit(){this.adminService.getAllWords().subscribe({next:t=>this.wordList=t})}getWordData(){return this.wordList.filter(t=>t.word.includes(this.search))}selectClick(t){this.router.navigate([`admin/edit-word/${t.id}`])}addNewWord(){this.router.navigate(["admin/create-word"])}addNewDialog(){this.router.navigate(["admin/create-dialog"])}openDialogsList(){this.router.navigate(["admin/dialogs-list"])}};i.\u0275fac=function(e){return new(e||i)(x(k),x(F))},i.\u0275cmp=w({type:i,selectors:[["app-admin-word-table"]],decls:12,vars:2,consts:[[1,"admin-word-table"],[1,"btn",3,"click"],["type","text",1,"admin-input-text",3,"ngModelChange","ngModel"],["class","word-list-data",3,"click",4,"ngFor","ngForOf"],[1,"word-list-data",3,"click"]],template:function(e,n){e&1&&(d(0,"div",0)(1,"div")(2,"button",1),_("click",function(){return n.addNewWord()}),s(3,"Add new word"),a(),d(4,"button",1),_("click",function(){return n.addNewDialog()}),s(5,"Add new dialog"),a(),d(6,"button",1),_("click",function(){return n.openDialogsList()}),s(7,"Open Dialogs List"),a()(),d(8,"div"),s(9," Search: "),d(10,"input",2),M("ngModelChange",function(v){return S(n.search,v)||(n.search=v),v}),a(),f(11,Pe,2,1,"div",3),a()()),e&2&&(l(10),y("ngModel",n.search),l(),m("ngForOf",n.getWordData()))},dependencies:[E,D,W,P],styles:[".admin-word-table[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{cursor:pointer;outline:0;display:inline-block;font-weight:400;line-height:1.5;text-align:center;background-color:transparent;border:1px solid #0d6efd;padding:6px 12px;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;color:#0d6efd}.admin-word-table[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.admin-word-table[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-word-table[_ngcontent-%COMP%]   .admin-input-text[_ngcontent-%COMP%]{line-height:1.5;border:1px solid #ccc;padding:7px 14px 9px;font-size:17px}.admin-word-table[_ngcontent-%COMP%]   .word-list-data[_ngcontent-%COMP%]{font-size:1.3em;margin:5px;padding:3px;border:1px solid grey;border-radius:5px}.admin-word-table[_ngcontent-%COMP%]   .word-list-data[_ngcontent-%COMP%]:hover{background-color:#e0ffff;cursor:pointer}"]});let o=i;return o})();var Ee=(()=>{let i=class i{constructor(t){this.route=t}ngOnInit(){console.log(this.route.snapshot.paramMap.get("id"))}};i.\u0275fac=function(e){return new(e||i)(x(q))},i.\u0275cmp=w({type:i,selectors:[["app-admin-edit-word"]],decls:2,vars:0,template:function(e,n){e&1&&(d(0,"p"),s(1,"admin-edit-word works!"),a())}});let o=i;return o})();var Ie=["audioInput"],Ve=["dynamicElements"];function Fe(o,i){if(o&1){let r=h();d(0,"div")(1,"button",5),_("click",function(){u(r);let e=p();return g(e.getTranslations())}),s(2,"Get translations "),a(),d(3,"button",5),_("click",function(){u(r);let e=p();return g(e.getDefinitions())}),s(4,"Get definitions "),a(),d(5,"button",5),_("click",function(){u(r);let e=p();return g(e.getExamples())}),s(6,"Get examples "),a()()}if(o&2){let r=p();l(),m("disabled",r.word.errors),l(2),m("disabled",r.word.errors),l(2),m("disabled",r.word.errors)}}function Ue(o,i){if(o&1&&(d(0,"audio",7),s(1,"AUDIO"),a()),o&2){let r=p(2);m("src",r.audioSrc,K)}}function Ne(o,i){if(o&1){let r=h();d(0,"div")(1,"button",2),_("click",function(){u(r);let e=p();return g(e.getAudioForWord())}),s(2,"Get audio"),a(),f(3,Ue,2,1,"audio",6),a()}if(o&2){let r=p();l(3),m("ngIf",r.audioSrc)}}function Le(o,i){o&1&&(d(0,"span"),s(1,"Save word"),a())}function $e(o,i){o&1&&(d(0,"span"),s(1,"Saved!"),a())}function ze(o,i){if(o&1){let r=h();d(0,"div")(1,"button",8),_("click",function(){u(r);let e=p();return g(e.saveNewWord())}),f(2,Le,2,0,"span",3)(3,$e,2,0,"span",3),a()()}if(o&2){let r=p();l(),m("disabled",!r.audioSrc||!r.word.value||r.wordId),l(),m("ngIf",!r.wordId),l(),m("ngIf",r.wordId)}}function je(o,i){if(o&1){let r=h();d(0,"div")(1,"input",11),M("ngModelChange",function(e){let n=u(r).$implicit;return S(n.translation,e)||(n.translation=e),g(e)}),a(),d(2,"select",12),M("ngModelChange",function(e){let n=u(r).$implicit;return S(n.language,e)||(n.language=e),g(e)}),d(3,"option"),s(4,"Russian"),a(),d(5,"option"),s(6,"Ukrainian"),a()(),d(7,"button",13),_("click",function(){let e=u(r).index,n=p(2);return g(n.delete("translations",e))}),s(8,"X"),a()()}if(o&2){let r=i.$implicit;l(),y("ngModel",r.translation),l(),y("ngModel",r.language)}}function Be(o,i){if(o&1){let r=h();d(0,"div")(1,"input",11),M("ngModelChange",function(e){let n=u(r).$implicit;return S(n.definition,e)||(n.definition=e),g(e)}),a(),d(2,"button",13),_("click",function(){let e=u(r).index,n=p(2);return g(n.delete("definitions",e))}),s(3,"X"),a()()}if(o&2){let r=i.$implicit;l(),y("ngModel",r.definition)}}function Re(o,i){if(o&1&&(d(0,"audio",7),s(1,"AUDIO"),a()),o&2){let r=p().index,t=p(2);m("src",t.examples[r].audioSrc,K)}}function Xe(o,i){if(o&1){let r=h();d(0,"button",10),_("click",function(){u(r);let e=p().index,n=p(2);return g(n.saveExample(e))}),s(1,"\u2713 "),a()}if(o&2){let r=p(3);m("disabled",!r.wordId)}}function qe(o,i){if(o&1){let r=h();d(0,"div")(1,"input",14),M("ngModelChange",function(e){let n=u(r).$implicit;return S(n.example,e)||(n.example=e),g(e)}),_("select",function(e){let n=u(r).index,c=p(2);return g(c.selected(e,n))}),a(),d(2,"span",15),s(3),a(),d(4,"span",15),s(5),a(),d(6,"button",2),_("click",function(){let e=u(r).index,n=p(2);return g(n.getAudioForExample(e))}),s(7,"Get audio"),a(),f(8,Re,2,1,"audio",6),d(9,"button",13),_("click",function(){let e=u(r).index,n=p(2);return g(n.delete("examples",e))}),s(10,"X"),a(),f(11,Xe,2,1,"button",16),a()}if(o&2){let r=i.$implicit,t=i.index,e=p(2);l(),y("ngModel",r.example),l(2),T(r.inclusionStart),l(2),T(r.inclusionEnd),l(3),m("ngIf",e.examples[t].audioSrc),l(3),m("ngIf",!e.examples[t].saved)}}function Ge(o,i){if(o&1){let r=h();d(0,"div")(1,"h3"),s(2,"Translations"),a(),d(3,"button",2),_("click",function(){u(r);let e=p();return g(e.addNewTranslation())}),s(4,"New translation"),a(),f(5,je,9,2,"div",9),d(6,"div")(7,"button",10),_("click",function(){u(r);let e=p();return g(e.saveTranslations())}),s(8,"\u2713 Save translations "),a()(),d(9,"h3"),s(10,"Definitions"),a(),d(11,"button",2),_("click",function(){u(r);let e=p();return g(e.addNewDefinition())}),s(12,"New definition"),a(),f(13,Be,4,1,"div",9),d(14,"div")(15,"button",10),_("click",function(){u(r);let e=p();return g(e.saveDefinitions())}),s(16,"\u2713 Save definitions "),a()(),d(17,"h3"),s(18,"Examples"),a(),d(19,"button",2),_("click",function(){u(r);let e=p();return g(e.addNewExample())}),s(20,"New example"),a(),f(21,qe,12,5,"div",9),a()}if(o&2){let r=p();l(5),m("ngForOf",r.translations),l(2),m("disabled",!r.wordId||!r.translations.length||r.translationsSaved),l(6),m("ngForOf",r.definitions),l(2),m("disabled",!r.wordId||!r.definitions.length||r.definitionsSaved),l(6),m("ngForOf",r.examples)}}var ke=(()=>{let i=class i{constructor(t,e){this.adminService=t,this.sanitizer=e,this.word=new ee(""),this.language=new ee(""),this.audioSrc="",this.pronunciation=null,this.translationsSaved=!1,this.definitionsSaved=!1,this.definitions=[],this.examples=[],this.translations=[]}saveExample(t){let e=this.examples[t].audio;if(!e){console.error("NO AUDIO ATTACHED");return}let n=this.examples[t],c=new FormData;return c.append("file",e),c.append("example",n.example),c.append("inclusionStart",n.inclusionStart.toString()),c.append("inclusionEnd",n.inclusionEnd.toString()),this.adminService.saveExample(this.wordId,c).subscribe({next:()=>this.examples[t].saved=!0})}getAudioForWord(){this.adminService.getAudioForPhrase(this.word.value).subscribe(t=>{this.pronunciation=t;let e=window.URL.createObjectURL(t);this.audioSrc=this.sanitizer.bypassSecurityTrustUrl(e)})}getAudioForExample(t){let e=this.examples[t].example;this.adminService.getAudioForPhrase(e,!0).subscribe(n=>{this.examples[t].audio=n;let c=window.URL.createObjectURL(n);this.examples[t].audioSrc=this.sanitizer.bypassSecurityTrustUrl(c)})}getDefinitions(){this.adminService.getDefinitions(this.word.value).subscribe({next:t=>{this.definitions=t.map(e=>({definition:e}))}})}getExamples(){this.adminService.getExamples(this.word.value).subscribe({next:t=>{this.examples=t.map(e=>({example:e,inclusionStart:0,inclusionEnd:0}))}})}getTranslations(){this.adminService.getTranslations(this.word.value).subscribe({next:t=>{this.translations=t.map(e=>({translation:e,language:"Russian"}))}})}selected(t,e){this.examples[e].inclusionStart=t.target.selectionStart,this.examples[e].inclusionEnd=t.target.selectionEnd-1}addNewDefinition(){this.definitions.push({definition:""})}addNewExample(){this.examples.push({example:"",inclusionEnd:0,inclusionStart:0})}addNewTranslation(){this.translations.push({translation:"",language:"Russian"})}delete(t,e){this[t].splice(e,1)}saveNewWord(){let t=new FormData;return t.append("file",this.pronunciation),t.append("word",this.word.value.trim()),this.adminService.saveWord(t).subscribe({next:e=>this.wordId=e.id})}saveTranslations(){this.adminService.saveTranslations(this.wordId,this.translations).subscribe({next:()=>this.translationsSaved=!0})}saveDefinitions(){this.adminService.saveDefinitions(this.wordId,this.definitions).subscribe({next:()=>this.definitionsSaved=!0})}reset(){this.wordId=null,this.word.setValue(""),this.audioSrc="",this.pronunciation=null,this.translationsSaved=!1,this.definitionsSaved=!1,this.definitions=[],this.translations=[],this.examples=[]}};i.\u0275fac=function(e){return new(e||i)(x(k),x(fe))},i.\u0275cmp=w({type:i,selectors:[["app-admin-create-word"]],viewQuery:function(e,n){if(e&1&&(Z(Ie,5),Z(Ve,5,me)),e&2){let c;Y(c=J())&&(n.audioInput=c.first),Y(c=J())&&(n.dynamicElements=c)}},decls:12,vars:5,consts:[[1,"admin-create-word"],["routerLink","/admin/word-table",1,"btn"],[1,"btn",3,"click"],[4,"ngIf"],["type","text",1,"admin-input-text",3,"formControl"],[1,"btn",3,"click","disabled"],["controls","",3,"src",4,"ngIf"],["controls","",3,"src"],[1,"btn","green",3,"click","disabled"],[4,"ngFor","ngForOf"],[1,"btn","save-btn",3,"click","disabled"],["type","text",1,"admin-input-text","texts",3,"ngModelChange","ngModel"],[1,"admin-input-text",3,"ngModelChange","ngModel"],[1,"btn","delete-btn",3,"click"],["type","text",1,"admin-input-text","texts",3,"ngModelChange","select","ngModel"],[1,"inclusion-span"],["class","btn save-btn",3,"disabled","click",4,"ngIf"]],template:function(e,n){e&1&&(d(0,"div",0)(1,"button",1),s(2,"Main Page"),a(),d(3,"button",2),_("click",function(){return n.reset()}),s(4,"RESET"),a(),f(5,Fe,7,3,"div",3),d(6,"h3"),s(7,"Word"),a(),A(8,"input",4),f(9,Ne,4,1,"div",3)(10,ze,4,3,"div",3)(11,Ge,22,5,"div",3),a()),e&2&&(l(5),m("ngIf",n.wordId),l(3),m("formControl",n.word),l(),m("ngIf",n.word.value),l(),m("ngIf",n.audioSrc),l(),m("ngIf",n.wordId))},dependencies:[E,B,I,R,X,D,ve,W,xe,P],styles:[".admin-create-word[_ngcontent-%COMP%]{overflow:scroll;height:100vh}.admin-create-word[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{cursor:pointer;outline:0;display:inline-block;font-weight:400;line-height:1.5;text-align:center;background-color:transparent;border:1px solid #0d6efd;padding:6px 12px;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;color:#0d6efd}.admin-create-word[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.admin-create-word[_ngcontent-%COMP%]   .btn.green[_ngcontent-%COMP%]{background-color:green;border:none}.admin-create-word[_ngcontent-%COMP%]   .btn.green[_ngcontent-%COMP%]{background-color:green;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .btn.green[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{background-color:#f6b0b0;color:#0d6efd}.admin-create-word[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{background-color:green;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .admin-input-text[_ngcontent-%COMP%]{line-height:1.5;border:1px solid #ccc;padding:7px 14px 9px;font-size:17px}.admin-create-word[_ngcontent-%COMP%]   .texts[_ngcontent-%COMP%]{width:60%}.admin-create-word[_ngcontent-%COMP%]   .inclusion-span[_ngcontent-%COMP%]{display:inline-block;border:1px solid grey;padding:5px;margin-right:10px;min-width:40px}"]});let o=i;return o})();var He=(o,i)=>({d_even:o,d_odd:i});function Qe(o,i){if(o&1&&(d(0,"option",13),s(1),a()),o&2){let r=i.$implicit;m("value",r.id),l(),T(r.word)}}function Ke(o,i){if(o&1){let r=h();d(0,"div")(1,"input",6),M("ngModelChange",function(e){let n=u(r).$implicit;return S(n.phrase,e)||(n.phrase=e),g(e)}),_("select",function(e){let n=u(r).index,c=p();return g(c.selected(e,n))}),a(),d(2,"input",7),M("ngModelChange",function(e){let n=u(r).$implicit;return S(n.wordId,e)||(n.wordId=e),g(e)}),a(),d(3,"datalist",8),f(4,Qe,2,2,"option",9),a(),d(5,"span",10),s(6),a(),d(7,"span",10),s(8),a(),A(9,"input",11),d(10,"span",12),_("click",function(){let e=u(r).index,n=p();return g(n.delete(e))}),s(11,"X"),a()()}if(o&2){let r=i.$implicit,t=i.index,e=p();l(),y("ngModel",r.phrase),m("ngClass",pe(6,He,t%2===0,t%2!==0)),l(),y("ngModel",r.wordId),l(2),m("ngForOf",e.wordList),l(2),T(r.inclusionStart),l(2),T(r.inclusionEnd)}}var Te=(()=>{let i=class i{constructor(t){this.adminService=t,this.dialog=[]}ngOnInit(){this.adminService.getAllWords().subscribe({next:t=>this.wordList=t})}addNewDialogLine(){this.dialog.push({phrase:""})}delete(t){this.dialog.splice(t,1)}selected(t,e){this.dialog[e].inclusionStart=t.target.selectionStart,this.dialog[e].inclusionEnd=t.target.selectionEnd-1}isValid(){let t=this.dialog.filter(e=>e.phrase&&(!e.wordId&&!e.inclusionStart&&!e.inclusionEnd||e.wordId&&ie(e.inclusionStart)&&ie(e.inclusionEnd)));return this.dialog.length&&t.length===this.dialog.length}composeRequest(t,e){let n=new FormData;return n.append("file",e),this.adminService.updatePhrasePronunciation(t.dialogId,t.id,n)}saveEverything(){let e=[...document.querySelectorAll(".dialog-file")].map(c=>(console.log(c.files),c.files[0])).filter(Boolean);if(e.length!==this.dialog.length){console.error("NOT ALL AUDIO ATTACHED");return}let n=this.dialog.map((c,v)=>{let L=re(oe({},c),{order:v,phrase:c.phrase.trim()});return c.wordId&&(L.wordId=Number(c.wordId)),L});return this.adminService.saveDialog(n).pipe(le(c=>de(c,ae))).pipe(se((c,v)=>this.composeRequest(c,e[v]))).subscribe({next:c=>{console.log("saved!"),this.dialog=[]},error:c=>{console.log(c),alert(c)}})}};i.\u0275fac=function(e){return new(e||i)(x(k))},i.\u0275cmp=w({type:i,selectors:[["app-admin-add-dialog"]],decls:11,vars:2,consts:[[1,"admin-create-dialog"],["routerLink","/admin/word-table",1,"btn"],[1,"btn",3,"click"],[1,"create-dialog-container"],[4,"ngFor","ngForOf"],[1,"btn",3,"click","disabled"],["type","text",1,"admin-input-text","texts",3,"ngModelChange","select","ngModel","ngClass"],["list","word-from-db",3,"ngModelChange","ngModel"],["id","word-from-db"],[3,"value",4,"ngFor","ngForOf"],[1,"inclusion-span"],["type","file","accept",".mp3",1,"dialog-file"],[1,"btn","delete-btn",3,"click"],[3,"value"]],template:function(e,n){e&1&&(d(0,"div",0)(1,"button",1),s(2,"Main Page"),a(),d(3,"h3"),s(4,"Dialog"),a(),d(5,"button",2),_("click",function(){return n.addNewDialogLine()}),s(6,"New phrase"),a(),d(7,"div",3),f(8,Ke,12,9,"div",4),a(),d(9,"button",5),_("click",function(){return n.saveEverything()}),s(10,"Save everything "),a()()),e&2&&(l(8),m("ngForOf",n.dialog),l(),m("disabled",!n.isValid()))},dependencies:[ue,E,I,R,X,D,W,P],styles:[".admin-create-dialog[_ngcontent-%COMP%]{margin:8px}.admin-create-dialog[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{background-color:#f6b0b0;color:#0d6efd}.admin-create-dialog[_ngcontent-%COMP%]   .create-dialog-container[_ngcontent-%COMP%]{overflow:scroll;max-height:70vh;margin:10px 0;border:2px solid grey}.admin-create-dialog[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{cursor:pointer;outline:0;display:inline-block;font-weight:400;line-height:1.5;text-align:center;background-color:transparent;border:1px solid #0d6efd;padding:6px 12px;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;color:#0d6efd}.admin-create-dialog[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.admin-create-dialog[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-create-dialog[_ngcontent-%COMP%]   .admin-input-text[_ngcontent-%COMP%]{line-height:1.5;border:1px solid #ccc;padding:7px 14px 9px;font-size:17px;margin:2px 0}.admin-create-dialog[_ngcontent-%COMP%]   .texts[_ngcontent-%COMP%]{width:70%}.admin-create-dialog[_ngcontent-%COMP%]   .inclusion-span[_ngcontent-%COMP%]{display:inline-block;border:1px solid grey;padding:5px;margin-right:10px;min-width:40px}.admin-create-dialog[_ngcontent-%COMP%]   .d_even[_ngcontent-%COMP%]{border-color:red}.admin-create-dialog[_ngcontent-%COMP%]   .d_odd[_ngcontent-%COMP%]{border-color:green}"]});let o=i;return o})();function Ze(o,i){if(o&1&&(d(0,"div")(1,"p")(2,"span"),s(3),a(),s(4," | "),d(5,"span"),s(6),a(),s(7," | "),d(8,"span"),s(9),a()()()),o&2){let r=i.$implicit;l(3),j("phrase: ",r.phrase,""),l(3),j("pronunciation: ",!!r.pronunciation,""),l(3),j("wordId: ",r.wordId,"")}}function Ye(o,i){if(o&1){let r=h();d(0,"div",2)(1,"button",3),_("click",function(){let e=u(r).$implicit,n=p();return g(n.editDialog(e))}),s(2,"Edit"),a(),f(3,Ze,10,3,"div",4),A(4,"hr"),a()}if(o&2){let r=i.$implicit;l(3),m("ngForOf",r)}}var Oe=(()=>{let i=class i{constructor(t,e){this.adminService=t,this.router=e,this.dialogs=[]}ngOnInit(){this.adminService.getAllDialogs().subscribe({next:t=>{this.dialogs=G(t),console.log(this.dialogs)}})}editDialog(t){this.router.navigate(["admin/edit-dialog"],{state:{data:t}})}};i.\u0275fac=function(e){return new(e||i)(x(k),x(F))},i.\u0275cmp=w({type:i,selectors:[["app-dialogs-list"]],decls:4,vars:1,consts:[["routerLink","/admin/word-table",1,"btn"],["class","dialog",4,"ngFor","ngForOf"],[1,"dialog"],[3,"click"],[4,"ngFor","ngForOf"]],template:function(e,n){e&1&&(d(0,"div")(1,"button",0),s(2,"Main Page"),a(),f(3,Ye,5,1,"div",1),a()),e&2&&(l(3),m("ngForOf",n.dialogs))},dependencies:[E,I],styles:[".dialog[_ngcontent-%COMP%]:nth-child(odd){background-color:#b2c1f6}.dialog[_ngcontent-%COMP%]:nth-child(2n){background-color:#ecccf6}"]});let o=i;return o})();function Je(o,i){o&1&&A(0,"input",8)}function et(o,i){if(o&1){let r=h();d(0,"button",9),_("click",function(){u(r);let e=p().index,n=p();return g(n.savePronunciation(e))}),s(1,"Save"),a()}}function tt(o,i){o&1&&(d(0,"audio",10),s(1,"AUDIO"),a())}function it(o,i){if(o&1){let r=h();d(0,"div",3)(1,"textarea",4),M("ngModelChange",function(e){let n=u(r).$implicit;return S(n.phrase,e)||(n.phrase=e),g(e)}),a(),f(2,Je,1,0,"input",5)(3,et,2,0,"button",6)(4,tt,2,0,"audio",7),a()}if(o&2){let r=i.$implicit;l(),y("ngModel",r.phrase),l(),m("ngIf",!r.pronunciation),l(),m("ngIf",!r.pronunciation),l(),m("ngIf",r.pronunciation)}}var De=(()=>{let i=class i{constructor(t,e,n){this.route=t,this.router=e,this.adminService=n,this.dialog=[],this.route.paramMap.subscribe(c=>{let v=window.history.state.data;v||this.router.navigate(["admin/dialogs-list"]),this.dialog=v,console.log("data"),console.log(v)})}savePronunciation(t){let n=document.querySelectorAll(".phrase-audio")[t].files[0];if(!n){console.error("NO AUDIO ATTACHED");return}console.log(n);let c=new FormData;c.append("file",n);let v=this.dialog[0].dialogId,L=this.dialog[t].id;return this.adminService.updatePhrasePronunciation(v,L,c).subscribe()}};i.\u0275fac=function(e){return new(e||i)(x(q),x(F),x(k))},i.\u0275cmp=w({type:i,selectors:[["app-edit-dialog"]],decls:4,vars:1,consts:[["routerLink","/admin/word-table",1,"btn"],[1,"container-of-all"],["class","container-of-phrases",4,"ngFor","ngForOf"],[1,"container-of-phrases"],["rows","3",1,"phrase",3,"ngModelChange","ngModel"],["type","file","accept",".mp3","class","phrase-audio",4,"ngIf"],[3,"click",4,"ngIf"],["controls","",4,"ngIf"],["type","file","accept",".mp3",1,"phrase-audio"],[3,"click"],["controls",""]],template:function(e,n){e&1&&(d(0,"button",0),s(1,"Main Page"),a(),d(2,"div",1),f(3,it,5,4,"div",2),a()),e&2&&(l(3),m("ngForOf",n.dialog))},dependencies:[E,B,I,D,W,P],styles:[".container-of-phrases[_ngcontent-%COMP%]{display:flex;justify-items:center;align-items:center}.phrase[_ngcontent-%COMP%]{width:70vw;resize:none;margin-bottom:10px}"]});let o=i;return o})();var nt=[{path:"",component:Me,canActivate:[V],data:{adminOnly:!0},children:[{path:"",redirectTo:"word-table",pathMatch:"full"},{path:"word-table",canActivate:[V],data:{adminOnly:!0},component:Ae},{path:"edit-word/:id",canActivate:[V],data:{adminOnly:!0},component:Ee},{path:"create-word",canActivate:[V],data:{adminOnly:!0},component:ke},{path:"create-dialog",canActivate:[V],data:{adminOnly:!0},component:Te},{path:"dialogs-list",canActivate:[V],data:{adminOnly:!0},component:Oe},{path:"edit-dialog",canActivate:[V],data:{adminOnly:!0},component:De}]}],We=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=z({type:i}),i.\u0275inj=$({imports:[te.forChild(nt),te]});let o=i;return o})();var ei=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=z({type:i}),i.\u0275inj=$({imports:[ge,We,we,Ce]});let o=i;return o})();export{ei as AdminModule};
