import{$ as v,A as J,Aa as Ce,D as C,Da as y,E as $,Fa as we,G as u,H as g,Ib as ke,K as he,Ma as B,N as L,Nb as Q,P as l,Q as x,Qb as re,Rb as Ee,Ub as V,V as f,Vb as k,W as c,Y as d,Ya as be,Z as a,_ as M,aa as _,b as le,ba as m,d as ce,db as D,e as me,eb as W,fa as ee,fb as ne,ga as te,gb as P,ha as ie,hb as Se,ia as s,ib as X,j as pe,ja as A,jb as G,ka as R,kb as q,l as ue,la as w,ma as b,na as S,nb as ye,o as Y,ob as Me,pa as xe,pb as H,qb as Ae,rb as U,sb as I,t as ge,tb as oe,u as _e,ua as ve,va as E,wa as F,x as fe,y as j}from"./chunk-PB5LIWOK.js";import{a as de,b as se}from"./chunk-4CLCTAJ7.js";var Te=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=C({type:n,selectors:[["app-admin"]],decls:1,vars:0,template:function(e,i){e&1&&M(0,"router-outlet")},dependencies:[Ae]});let o=n;return o})();var T=(()=>{let n=class n{constructor(t,e){this.http=t,this.store=e,this.allWordsUrl=`${k.apiUrl}/admin/words`,this.baseDefinitionsUrl=`${k.apiUrl}/admin/definitions`,this.baseExamplesUrl=`${k.apiUrl}/admin/examples`,this.baseTranslationsUrl=`${k.apiUrl}/admin/translations`,this.saveWordUrl=`${k.apiUrl}/admin/words`,this.getAudioUrl=i=>`https://api.elevenlabs.io/v1/text-to-speech/${i}`,this.getSaveDefinitionsUrl=i=>`${k.apiUrl}/admin/words/${i}/definitions`,this.getSaveExamplesUrl=i=>`${k.apiUrl}/admin/words/${i}/example`,this.getSaveTranslationsUrl=i=>`${k.apiUrl}/admin/words/${i}/translations`,this.updatePhrasePronunciationUrl=(i,p)=>`${k.apiUrl}/admin/dialogs/${i}/phrase/${p}/pronunciation`,this.dialogsUrl=`${k.apiUrl}/admin/dialogs`,this.audioVoices={word:"onwK4e9ZLuTAKqWW03F9",Rachel:"21m00Tcm4TlvDq8ikWAM",Drew:"29vD33N1CtxCmqQRPOHJ",Clyde:"2EiwWnXFnvU5JabPnv8n",Paul:"5Q0t7uMcjvnagumLfvZi",Domi:"AZnzlk1XvdvUeBnXmlld",Dave:"CYw3kZ02Hs0563khs1Fj",Fin:"D38z5RcWu1voky8WS1ja",Sarah:"EXAVITQu4vr4xnSDxMaL",Antoni:"ErXwobaYiN019PkySvjV",Thomas:"GBv7mTt0atIp3Br8iCZE",Charlie:"IKne3meq5aSn9XLyUdCD",George:"JBFqnCBsd6RMkjVDRZzb",Emily:"LcfcDJNUP1GQjkzn1xUU",Elli:"MF3mGyEYCl7XYWbV9V6O",Callum:"N2lVS1w4EtoT3dr4eOWO",Patrick:"ODq5zmih8GrVes37Dizd",Harry:"SOYHLrjzK2X1ezoPC6cr",Liam:"TX3LPaxmHKxFdv7VOQHJ",Dorothy:"ThT5KcBeYPX3keUQqHPh",Josh:"TxGEqnHWrfWFTfGW9XjX",Matilda:"XrExE9yKIg1WjnnlVkGX",Michael:"flq6f7yk4E4fJM5XTYuZ",Ethan:"g5CIjZEefAph4nQFvHAz",Gigi:"jBpfuIE2acCO8z3wKNLl",Freya:"jsCqWAovK2LkecY7zXl4",Grace:"oWAxZDx7w5VEj9dCyTzz"},this.audioModelId="eleven_multilingual_v2"}getToken(){return this.store.selectSnapshot(ke.token)}updatePhrasePronunciation(t,e,i){return this.http.patch(this.updatePhrasePronunciationUrl(t,e),i,{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}getAllDialogs(){return this.http.get(this.dialogsUrl,{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}getAllWords(){return this.http.get(this.allWordsUrl,{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}getDefinitions(t){return this.http.get(`${this.baseDefinitionsUrl}/${t}`,{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}getExamples(t){return this.http.get(`${this.baseExamplesUrl}/${t}`,{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}getTranslations(t){return this.http.get(`${this.baseTranslationsUrl}/${t}`,{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}saveWord(t){return this.http.post(this.saveWordUrl,t,{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}saveDefinitions(t,e){return this.http.post(this.getSaveDefinitionsUrl(t),{definitions:e},{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}saveTranslations(t,e){return this.http.post(this.getSaveTranslationsUrl(t),{translations:e},{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}saveExample(t,e){return this.http.post(this.getSaveExamplesUrl(t),e,{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}getAudioForPhrase(t,e){let i=e||Ee(Q(this.audioVoices)),p=this.audioVoices[i],h=this.getAudioUrl(p),Z={text:t,model_id:this.audioModelId};return this.http.post(h,Z,{responseType:"blob",headers:new y({Accept:"audio/mpeg","Content-Type":"application/json","xi-api-key":"877030f988b65342aa6ad0eaccc49b7d"})})}saveDialog(t){return this.http.post(this.dialogsUrl,{dialog:t},{headers:new y({Authorization:`Bearer ${this.getToken()}`})})}};n.\u0275fac=function(e){return new(e||n)(J(we),J(be))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"});let o=n;return o})();function Ue(o,n){if(o&1){let r=v();d(0,"div",4),_("click",function(){let e=u(r).$implicit,i=m();return g(i.selectClick(e))}),s(1),a()}if(o&2){let r=n.$implicit;l(),A(r.word)}}var Oe=(()=>{let n=class n{constructor(t,e){this.adminService=t,this.router=e,this.wordList=[],this.search=""}ngOnInit(){this.adminService.getAllWords().subscribe({next:t=>this.wordList=t})}getWordData(){return this.wordList.filter(t=>t.word.includes(this.search))}selectClick(t){this.router.navigate([`admin/edit-word/${t.id}`])}addNewWord(){this.router.navigate(["admin/create-word"])}addNewDialog(){this.router.navigate(["admin/create-dialog"])}openDialogsList(){this.router.navigate(["admin/dialogs-list"])}};n.\u0275fac=function(e){return new(e||n)(x(T),x(U))},n.\u0275cmp=C({type:n,selectors:[["app-admin-word-table"]],decls:12,vars:2,consts:[[1,"admin-word-table"],[1,"btn",3,"click"],["type","text",1,"admin-input-text",3,"ngModelChange","ngModel"],["class","word-list-data",3,"click",4,"ngFor","ngForOf"],[1,"word-list-data",3,"click"]],template:function(e,i){e&1&&(d(0,"div",0)(1,"div")(2,"button",1),_("click",function(){return i.addNewWord()}),s(3,"Add new word"),a(),d(4,"button",1),_("click",function(){return i.addNewDialog()}),s(5,"Add new dialog"),a(),d(6,"button",1),_("click",function(){return i.openDialogsList()}),s(7,"Open Dialogs List"),a()(),d(8,"div"),s(9," Search: "),d(10,"input",2),S("ngModelChange",function(h){return b(i.search,h)||(i.search=h),h}),a(),f(11,Ue,2,1,"div",3),a()()),e&2&&(l(10),w("ngModel",i.search),l(),c("ngForOf",i.getWordData()))},dependencies:[E,D,W,P],styles:[".admin-word-table[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{cursor:pointer;outline:0;display:inline-block;font-weight:400;line-height:1.5;text-align:center;background-color:transparent;border:1px solid #0d6efd;padding:6px 12px;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;color:#0d6efd}.admin-word-table[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.admin-word-table[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-word-table[_ngcontent-%COMP%]   .admin-input-text[_ngcontent-%COMP%]{line-height:1.5;border:1px solid #ccc;padding:7px 14px 9px;font-size:17px}.admin-word-table[_ngcontent-%COMP%]   .word-list-data[_ngcontent-%COMP%]{font-size:1.3em;margin:5px;padding:3px;border:1px solid grey;border-radius:5px}.admin-word-table[_ngcontent-%COMP%]   .word-list-data[_ngcontent-%COMP%]:hover{background-color:#e0ffff;cursor:pointer}"]});let o=n;return o})();var De=(()=>{let n=class n{constructor(t){this.route=t}ngOnInit(){console.log(this.route.snapshot.paramMap.get("id"))}};n.\u0275fac=function(e){return new(e||n)(x(H))},n.\u0275cmp=C({type:n,selectors:[["app-admin-edit-word"]],decls:2,vars:0,template:function(e,i){e&1&&(d(0,"p"),s(1,"admin-edit-word works!"),a())}});let o=n;return o})();var Le=["audioInput"],ze=["dynamicElements"];function je(o,n){if(o&1){let r=v();d(0,"div")(1,"button",5),_("click",function(){u(r);let e=m();return g(e.getTranslations())}),s(2,"Get translations "),a(),d(3,"button",5),_("click",function(){u(r);let e=m();return g(e.getDefinitions())}),s(4,"Get definitions "),a(),d(5,"button",5),_("click",function(){u(r);let e=m();return g(e.getExamples())}),s(6,"Get examples "),a()()}if(o&2){let r=m();l(),c("disabled",r.word.errors),l(2),c("disabled",r.word.errors),l(2),c("disabled",r.word.errors)}}function $e(o,n){if(o&1&&(d(0,"audio",7),s(1,"AUDIO"),a()),o&2){let r=m(2);c("src",r.audioSrc,L)}}function Re(o,n){if(o&1){let r=v();d(0,"div")(1,"button",2),_("click",function(){u(r);let e=m();return g(e.getAudioForWord())}),s(2,"Get audio"),a(),f(3,$e,2,1,"audio",6),a()}if(o&2){let r=m();l(3),c("ngIf",r.audioSrc)}}function Be(o,n){o&1&&(d(0,"span"),s(1,"Save word"),a())}function Xe(o,n){o&1&&(d(0,"span"),s(1,"Saved!"),a())}function Ge(o,n){if(o&1){let r=v();d(0,"div")(1,"button",8),_("click",function(){u(r);let e=m();return g(e.saveNewWord())}),f(2,Be,2,0,"span",3)(3,Xe,2,0,"span",3),a()()}if(o&2){let r=m();l(),c("disabled",!r.audioSrc||!r.word.value||r.wordId),l(),c("ngIf",!r.wordId),l(),c("ngIf",r.wordId)}}function qe(o,n){if(o&1){let r=v();d(0,"div")(1,"input",12),S("ngModelChange",function(e){let i=u(r).$implicit;return b(i.translation,e)||(i.translation=e),g(e)}),a(),d(2,"select",13),S("ngModelChange",function(e){let i=u(r).$implicit;return b(i.language,e)||(i.language=e),g(e)}),d(3,"option"),s(4,"Russian"),a(),d(5,"option"),s(6,"Ukrainian"),a()(),d(7,"button",14),_("click",function(){let e=u(r).index,i=m(2);return g(i.delete("translations",e))}),s(8,"X"),a()()}if(o&2){let r=n.$implicit;l(),w("ngModel",r.translation),l(),w("ngModel",r.language)}}function He(o,n){if(o&1){let r=v();d(0,"div")(1,"input",12),S("ngModelChange",function(e){let i=u(r).$implicit;return b(i.definition,e)||(i.definition=e),g(e)}),a(),d(2,"button",14),_("click",function(){let e=u(r).index,i=m(2);return g(i.delete("definitions",e))}),s(3,"X"),a()()}if(o&2){let r=n.$implicit;l(),w("ngModel",r.definition)}}function Qe(o,n){if(o&1&&(d(0,"audio",7),s(1,"AUDIO"),a()),o&2){let r=m().index,t=m(2);c("src",t.examples[r].audioSrc,L)}}function Ke(o,n){if(o&1){let r=v();d(0,"button",10),_("click",function(){u(r);let e=m().index,i=m(2);return g(i.saveExample(e))}),s(1,"\u2713 "),a()}if(o&2){let r=m(3);c("disabled",!r.wordId)}}function Ze(o,n){if(o&1){let r=v();d(0,"div",15)(1,"textarea",16),S("ngModelChange",function(e){let i=u(r).$implicit;return b(i.example,e)||(i.example=e),g(e)}),_("select",function(e){let i=u(r).index,p=m(2);return g(p.selected(e,i))}),a(),d(2,"span",17),s(3),a(),d(4,"span",17),s(5),a(),d(6,"button",2),_("click",function(){let e=u(r).index,i=m(2);return g(i.getAudioForExample(e))}),s(7,"Get audio"),a(),f(8,Qe,2,1,"audio",6),d(9,"button",14),_("click",function(){let e=u(r).index,i=m(2);return g(i.delete("examples",e))}),s(10,"X"),a(),f(11,Ke,2,1,"button",18),a()}if(o&2){let r=n.$implicit,t=n.index,e=m(2);l(),w("ngModel",r.example),l(2),A(r.inclusionStart),l(2),A(r.inclusionEnd),l(3),c("ngIf",e.examples[t].audioSrc),l(3),c("ngIf",!e.examples[t].saved)}}function Ye(o,n){if(o&1){let r=v();d(0,"div")(1,"h3"),s(2,"Translations"),a(),d(3,"button",2),_("click",function(){u(r);let e=m();return g(e.addNewTranslation())}),s(4,"New translation"),a(),f(5,qe,9,2,"div",9),d(6,"div")(7,"button",10),_("click",function(){u(r);let e=m();return g(e.saveTranslations())}),s(8,"\u2713 Save translations "),a()(),d(9,"h3"),s(10,"Definitions"),a(),d(11,"button",2),_("click",function(){u(r);let e=m();return g(e.addNewDefinition())}),s(12,"New definition"),a(),f(13,He,4,1,"div",9),d(14,"div")(15,"button",10),_("click",function(){u(r);let e=m();return g(e.saveDefinitions())}),s(16,"\u2713 Save definitions "),a()(),d(17,"h3"),s(18,"Examples"),a(),d(19,"button",2),_("click",function(){u(r);let e=m();return g(e.addNewExample())}),s(20,"New example"),a(),f(21,Ze,12,5,"div",11),a()}if(o&2){let r=m();l(5),c("ngForOf",r.translations),l(2),c("disabled",!r.wordId||!r.translations.length||r.translationsSaved),l(6),c("ngForOf",r.definitions),l(2),c("disabled",!r.wordId||!r.definitions.length||r.definitionsSaved),l(6),c("ngForOf",r.examples)}}var We=(()=>{let n=class n{constructor(t,e){this.adminService=t,this.sanitizer=e,this.word=new ne(""),this.language=new ne(""),this.audioSrc="",this.pronunciation=null,this.translationsSaved=!1,this.definitionsSaved=!1,this.definitions=[],this.examples=[],this.translations=[]}saveExample(t){let e=this.examples[t].audio;if(!e){console.error("NO AUDIO ATTACHED");return}let i=this.examples[t],p=new FormData;return p.append("file",e),p.append("example",i.example),p.append("inclusionStart",i.inclusionStart.toString()),p.append("inclusionEnd",i.inclusionEnd.toString()),this.adminService.saveExample(this.wordId,p).subscribe({next:()=>this.examples[t].saved=!0})}getAudioForWord(){this.adminService.getAudioForPhrase(this.word.value,this.adminService.audioVoices.word).subscribe(t=>{this.pronunciation=t;let e=window.URL.createObjectURL(t);this.audioSrc=this.sanitizer.bypassSecurityTrustUrl(e)})}getAudioForExample(t){let e=this.examples[t].example;this.adminService.getAudioForPhrase(e).subscribe(i=>{this.examples[t].audio=i;let p=window.URL.createObjectURL(i);this.examples[t].audioSrc=this.sanitizer.bypassSecurityTrustUrl(p)})}getDefinitions(){this.adminService.getDefinitions(this.word.value).subscribe({next:t=>{this.definitions=t.map(e=>({definition:e}))}})}getExamples(){this.adminService.getExamples(this.word.value).subscribe({next:t=>{this.examples=t.map(e=>({example:e,inclusionStart:0,inclusionEnd:0}))}})}getTranslations(){this.adminService.getTranslations(this.word.value).subscribe({next:t=>{this.translations=t.map(e=>({translation:e,language:"Russian"}))}})}selected(t,e){this.examples[e].inclusionStart=t.target.selectionStart,this.examples[e].inclusionEnd=t.target.selectionEnd-1}addNewDefinition(){this.definitions.push({definition:""})}addNewExample(){this.examples.push({example:"",inclusionEnd:0,inclusionStart:0})}addNewTranslation(){this.translations.push({translation:"",language:"Russian"})}delete(t,e){this[t].splice(e,1)}saveNewWord(){let t=new FormData;return t.append("file",this.pronunciation),t.append("word",this.word.value.trim()),this.adminService.saveWord(t).subscribe({next:e=>this.wordId=e.id})}saveTranslations(){this.adminService.saveTranslations(this.wordId,this.translations).subscribe({next:()=>this.translationsSaved=!0})}saveDefinitions(){this.adminService.saveDefinitions(this.wordId,this.definitions).subscribe({next:()=>this.definitionsSaved=!0})}reset(){this.wordId=null,this.word.setValue(""),this.audioSrc="",this.pronunciation=null,this.translationsSaved=!1,this.definitionsSaved=!1,this.definitions=[],this.translations=[],this.examples=[]}};n.\u0275fac=function(e){return new(e||n)(x(T),x(B))},n.\u0275cmp=C({type:n,selectors:[["app-admin-create-word"]],viewQuery:function(e,i){if(e&1&&(ee(Le,5),ee(ze,5,he)),e&2){let p;te(p=ie())&&(i.audioInput=p.first),te(p=ie())&&(i.dynamicElements=p)}},decls:12,vars:5,consts:[[1,"admin-create-word"],["routerLink","/admin/word-table",1,"btn"],[1,"btn",3,"click"],[4,"ngIf"],["type","text",1,"admin-input-text",3,"formControl"],[1,"btn",3,"click","disabled"],["controls","",3,"src",4,"ngIf"],["controls","",3,"src"],[1,"btn","green",3,"click","disabled"],[4,"ngFor","ngForOf"],[1,"btn","save-btn",3,"click","disabled"],["class","example-configuration",4,"ngFor","ngForOf"],["type","text",1,"admin-input-text","texts",3,"ngModelChange","ngModel"],[1,"admin-input-text",3,"ngModelChange","ngModel"],[1,"btn","delete-btn",3,"click"],[1,"example-configuration"],[1,"admin-input-text","texts",3,"ngModelChange","select","ngModel"],[1,"inclusion-span"],["class","btn save-btn",3,"disabled","click",4,"ngIf"]],template:function(e,i){e&1&&(d(0,"div",0)(1,"button",1),s(2,"Main Page"),a(),d(3,"button",2),_("click",function(){return i.reset()}),s(4,"RESET"),a(),f(5,je,7,3,"div",3),d(6,"h3"),s(7,"Word"),a(),M(8,"input",4),f(9,Re,4,1,"div",3)(10,Ge,4,3,"div",3)(11,Ye,22,5,"div",3),a()),e&2&&(l(5),c("ngIf",i.wordId),l(3),c("formControl",i.word),l(),c("ngIf",i.word.value),l(),c("ngIf",i.audioSrc),l(),c("ngIf",i.wordId))},dependencies:[E,F,I,G,q,D,X,W,Se,P],styles:[".admin-create-word[_ngcontent-%COMP%]{overflow:scroll;height:100vh}.admin-create-word[_ngcontent-%COMP%]   .example-configuration[_ngcontent-%COMP%]{display:flex}.admin-create-word[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{cursor:pointer;outline:0;display:inline-block;font-weight:400;line-height:1.5;text-align:center;background-color:transparent;border:1px solid #0d6efd;padding:6px 12px;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;color:#0d6efd}.admin-create-word[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.admin-create-word[_ngcontent-%COMP%]   .btn.green[_ngcontent-%COMP%]{background-color:green;border:none}.admin-create-word[_ngcontent-%COMP%]   .btn.green[_ngcontent-%COMP%]{background-color:green;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .btn.green[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{background-color:#f6b0b0;color:#0d6efd}.admin-create-word[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{background-color:green;color:#fff}.admin-create-word[_ngcontent-%COMP%]   .admin-input-text[_ngcontent-%COMP%]{line-height:1.5;border:1px solid #ccc;padding:7px 14px 9px;font-size:17px}.admin-create-word[_ngcontent-%COMP%]   .texts[_ngcontent-%COMP%]{width:60%}.admin-create-word[_ngcontent-%COMP%]   .inclusion-span[_ngcontent-%COMP%]{display:inline-block;border:1px solid grey;padding:5px;margin-right:10px;min-width:40px}"]});let o=n;return o})();var Je=(o,n)=>({d_even:o,d_odd:n});function et(o,n){if(o&1&&(d(0,"option"),s(1),a()),o&2){let r=n.$implicit;l(),A(r)}}function tt(o,n){if(o&1&&(d(0,"option"),s(1),a()),o&2){let r=n.$implicit;l(),A(r)}}function it(o,n){if(o&1&&(d(0,"option",16),s(1),a()),o&2){let r=n.$implicit;c("value",r.id),l(),A(r.word)}}function nt(o,n){if(o&1&&M(0,"audio",17),o&2){let r=m().index,t=m();c("src",t.audioData[r]==null?null:t.audioData[r].audioSrc,L)}}function ot(o,n){if(o&1){let r=v();d(0,"div",8)(1,"textarea",9),S("ngModelChange",function(e){let i=u(r).$implicit;return b(i.phrase,e)||(i.phrase=e),g(e)}),_("select",function(e){let i=u(r).index,p=m();return g(p.selected(e,i))}),a(),d(2,"input",10),S("ngModelChange",function(e){let i=u(r).$implicit;return b(i.wordId,e)||(i.wordId=e),g(e)}),a(),d(3,"datalist",11),f(4,it,2,2,"option",12),a(),d(5,"span",13),s(6),a(),d(7,"span",13),s(8),a(),f(9,nt,1,1,"audio",14),d(10,"span",15),_("click",function(){let e=u(r).index,i=m();return g(i.delete(e))}),s(11,"X"),a()()}if(o&2){let r=n.$implicit,t=n.index,e=m();l(),w("ngModel",r.phrase),c("ngClass",xe(7,Je,t%2===0,t%2!==0)),l(),w("ngModel",r.wordId),l(2),c("ngForOf",e.wordList),l(2),A(r.inclusionStart),l(2),A(r.inclusionEnd),l(),c("ngIf",e.audioData[t]==null?null:e.audioData[t].audioSrc)}}var Pe=(()=>{let n=class n{constructor(t,e){this.adminService=t,this.sanitizer=e,this.dialog=[],this.audioData=[],this.voices=Object.keys(this.adminService.audioVoices)}ngOnInit(){this.adminService.getAllWords().subscribe({next:t=>this.wordList=t})}getAudios(){me(this.dialog).pipe(Y((t,e)=>ue(3e3*e).pipe(pe(()=>this.adminService.getAudioForPhrase(t.phrase,e%2?this.secondSpeaker:this.firstSpeaker).pipe(_e(i=>{this.audioData[e]={blob:i,audioSrc:this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(i))}})))))).subscribe(()=>{})}addNewDialogLine(){this.dialog.push({phrase:""})}delete(t){this.dialog.splice(t,1)}selected(t,e){this.dialog[e].inclusionStart=t.target.selectionStart,this.dialog[e].inclusionEnd=t.target.selectionEnd-1}isValid(){let t=this.dialog.filter(e=>e.phrase&&(!e.wordId&&!e.inclusionStart&&!e.inclusionEnd||e.wordId&&re(e.inclusionStart)&&re(e.inclusionEnd)));return this.dialog.length&&t.length===this.dialog.length}composeRequest(t,e){let i=new FormData;return i.append("file",this.audioData[e].blob),this.adminService.updatePhrasePronunciation(t.dialogId,t.id,i)}saveEverything(){if(this.dialog.length!==this.audioData.length){console.error("NOT ALL AUDIO ATTACHED");return}let t=this.dialog.map((e,i)=>{let p=se(de({},e),{order:i,phrase:e.phrase.trim()});return e.wordId&&(p.wordId=Number(e.wordId)),p});return this.adminService.saveDialog(t).pipe(ge(e=>ce(e,le))).pipe(Y((e,i)=>this.composeRequest(e,i))).subscribe({next:e=>{console.log("saved!"),this.dialog=[]},error:e=>{console.log(e),alert(e)}})}};n.\u0275fac=function(e){return new(e||n)(x(T),x(B))},n.\u0275cmp=C({type:n,selectors:[["app-admin-add-dialog"]],decls:22,vars:7,consts:[[1,"admin-create-dialog"],["routerLink","/admin/word-table",1,"btn"],[3,"ngModelChange","ngModel"],[4,"ngFor","ngForOf"],[1,"btn",3,"click"],[1,"create-dialog-container"],["class","dialog-phrase-config",4,"ngFor","ngForOf"],[1,"btn",3,"click","disabled"],[1,"dialog-phrase-config"],[1,"admin-input-text","texts",3,"ngModelChange","select","ngModel","ngClass"],["list","word-from-db",3,"ngModelChange","ngModel"],["id","word-from-db"],[3,"value",4,"ngFor","ngForOf"],[1,"inclusion-span"],["controls","",3,"src",4,"ngIf"],[1,"btn","delete-btn",3,"click"],[3,"value"],["controls","",3,"src"]],template:function(e,i){e&1&&(d(0,"div",0)(1,"button",1),s(2,"Main Page"),a(),d(3,"h3"),s(4,"Dialog"),a(),d(5,"h5"),s(6,"First speaker:"),a(),d(7,"select",2),S("ngModelChange",function(h){return b(i.firstSpeaker,h)||(i.firstSpeaker=h),h}),f(8,et,2,1,"option",3),a(),d(9,"h5"),s(10,"Second speaker:"),a(),d(11,"select",2),S("ngModelChange",function(h){return b(i.secondSpeaker,h)||(i.secondSpeaker=h),h}),f(12,tt,2,1,"option",3),a(),M(13,"hr"),d(14,"button",4),_("click",function(){return i.addNewDialogLine()}),s(15,"New phrase"),a(),d(16,"div",5),f(17,ot,12,10,"div",6),a(),d(18,"button",7),_("click",function(){return i.getAudios()}),s(19,"Get audios "),a(),d(20,"button",7),_("click",function(){return i.saveEverything()}),s(21,"Save everything "),a()()),e&2&&(l(7),w("ngModel",i.firstSpeaker),l(),c("ngForOf",i.voices),l(3),w("ngModel",i.secondSpeaker),l(),c("ngForOf",i.voices),l(5),c("ngForOf",i.dialog),l(),c("disabled",!i.firstSpeaker||!i.secondSpeaker),l(2),c("disabled",!i.isValid()))},dependencies:[ve,E,F,I,G,q,D,X,W,P],styles:[".admin-create-dialog[_ngcontent-%COMP%]{margin:8px}.admin-create-dialog[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{background-color:#f6b0b0;color:#0d6efd}.admin-create-dialog[_ngcontent-%COMP%]   .dialog-phrase-config[_ngcontent-%COMP%]{display:flex}.admin-create-dialog[_ngcontent-%COMP%]   .create-dialog-container[_ngcontent-%COMP%]{overflow:scroll;max-height:70vh;margin:10px 0}.admin-create-dialog[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{cursor:pointer;outline:0;display:inline-block;font-weight:400;line-height:1.5;text-align:center;background-color:transparent;border:1px solid #0d6efd;padding:6px 12px;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;color:#0d6efd}.admin-create-dialog[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.admin-create-dialog[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.admin-create-dialog[_ngcontent-%COMP%]   .admin-input-text[_ngcontent-%COMP%]{line-height:1.5;border:2px solid #ccc;padding:7px 14px 9px;font-size:17px;margin:2px 0}.admin-create-dialog[_ngcontent-%COMP%]   .texts[_ngcontent-%COMP%]{width:70%}.admin-create-dialog[_ngcontent-%COMP%]   .inclusion-span[_ngcontent-%COMP%]{display:inline-block;border:1px solid grey;padding:5px;margin-right:10px;min-width:40px}.admin-create-dialog[_ngcontent-%COMP%]   .d_even[_ngcontent-%COMP%]{border-color:red}.admin-create-dialog[_ngcontent-%COMP%]   .d_odd[_ngcontent-%COMP%]{border-color:green}"]});let o=n;return o})();function rt(o,n){if(o&1&&(d(0,"div")(1,"p")(2,"span"),s(3),a(),s(4," | "),d(5,"span"),s(6),a(),s(7," | "),d(8,"span"),s(9),a()()()),o&2){let r=n.$implicit;l(3),R("phrase: ",r.phrase,""),l(3),R("pronunciation: ",!!r.pronunciation,""),l(3),R("wordId: ",r.wordId,"")}}function at(o,n){if(o&1){let r=v();d(0,"div",2)(1,"button",3),_("click",function(){let e=u(r).$implicit,i=m();return g(i.editDialog(e))}),s(2,"Edit"),a(),f(3,rt,10,3,"div",4),M(4,"hr"),a()}if(o&2){let r=n.$implicit;l(3),c("ngForOf",r)}}var Ie=(()=>{let n=class n{constructor(t,e){this.adminService=t,this.router=e,this.dialogs=[]}ngOnInit(){this.adminService.getAllDialogs().subscribe({next:t=>{this.dialogs=Q(t),console.log(this.dialogs)}})}editDialog(t){this.router.navigate(["admin/edit-dialog"],{state:{data:t}})}};n.\u0275fac=function(e){return new(e||n)(x(T),x(U))},n.\u0275cmp=C({type:n,selectors:[["app-dialogs-list"]],decls:4,vars:1,consts:[["routerLink","/admin/word-table",1,"btn"],["class","dialog",4,"ngFor","ngForOf"],[1,"dialog"],[3,"click"],[4,"ngFor","ngForOf"]],template:function(e,i){e&1&&(d(0,"div")(1,"button",0),s(2,"Main Page"),a(),f(3,at,5,1,"div",1),a()),e&2&&(l(3),c("ngForOf",i.dialogs))},dependencies:[E,I],styles:[".dialog[_ngcontent-%COMP%]:nth-child(odd){background-color:#b2c1f6}.dialog[_ngcontent-%COMP%]:nth-child(2n){background-color:#ecccf6}"]});let o=n;return o})();function dt(o,n){o&1&&M(0,"input",8)}function st(o,n){if(o&1){let r=v();d(0,"button",9),_("click",function(){u(r);let e=m().index,i=m();return g(i.savePronunciation(e))}),s(1,"Save"),a()}}function lt(o,n){o&1&&(d(0,"audio",10),s(1,"AUDIO"),a())}function ct(o,n){if(o&1){let r=v();d(0,"div",3)(1,"textarea",4),S("ngModelChange",function(e){let i=u(r).$implicit;return b(i.phrase,e)||(i.phrase=e),g(e)}),a(),f(2,dt,1,0,"input",5)(3,st,2,0,"button",6)(4,lt,2,0,"audio",7),a()}if(o&2){let r=n.$implicit;l(),w("ngModel",r.phrase),l(),c("ngIf",!r.pronunciation),l(),c("ngIf",!r.pronunciation),l(),c("ngIf",r.pronunciation)}}var Ve=(()=>{let n=class n{constructor(t,e,i){this.route=t,this.router=e,this.adminService=i,this.dialog=[],this.route.paramMap.subscribe(p=>{let h=window.history.state.data;h||this.router.navigate(["admin/dialogs-list"]),this.dialog=h,console.log("data"),console.log(h)})}savePronunciation(t){let i=document.querySelectorAll(".phrase-audio")[t].files[0];if(!i){console.error("NO AUDIO ATTACHED");return}console.log(i);let p=new FormData;p.append("file",i);let h=this.dialog[0].dialogId,Z=this.dialog[t].id;return this.adminService.updatePhrasePronunciation(h,Z,p).subscribe()}};n.\u0275fac=function(e){return new(e||n)(x(H),x(U),x(T))},n.\u0275cmp=C({type:n,selectors:[["app-edit-dialog"]],decls:4,vars:1,consts:[["routerLink","/admin/word-table",1,"btn"],[1,"container-of-all"],["class","container-of-phrases",4,"ngFor","ngForOf"],[1,"container-of-phrases"],["rows","3",1,"phrase",3,"ngModelChange","ngModel"],["type","file","accept",".mp3","class","phrase-audio",4,"ngIf"],[3,"click",4,"ngIf"],["controls","",4,"ngIf"],["type","file","accept",".mp3",1,"phrase-audio"],[3,"click"],["controls",""]],template:function(e,i){e&1&&(d(0,"button",0),s(1,"Main Page"),a(),d(2,"div",1),f(3,ct,5,4,"div",2),a()),e&2&&(l(3),c("ngForOf",i.dialog))},dependencies:[E,F,I,D,W,P],styles:[".container-of-phrases[_ngcontent-%COMP%]{display:flex;justify-items:center;align-items:center}.phrase[_ngcontent-%COMP%]{width:70vw;resize:none;margin-bottom:10px}"]});let o=n;return o})();var mt=[{path:"",component:Te,canActivate:[V],data:{adminOnly:!0},children:[{path:"",redirectTo:"word-table",pathMatch:"full"},{path:"word-table",canActivate:[V],data:{adminOnly:!0},component:Oe},{path:"edit-word/:id",canActivate:[V],data:{adminOnly:!0},component:De},{path:"create-word",canActivate:[V],data:{adminOnly:!0},component:We},{path:"create-dialog",canActivate:[V],data:{adminOnly:!0},component:Pe},{path:"dialogs-list",canActivate:[V],data:{adminOnly:!0},component:Ie},{path:"edit-dialog",canActivate:[V],data:{adminOnly:!0},component:Ve}]}],Fe=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=$({type:n}),n.\u0275inj=j({imports:[oe.forChild(mt),oe]});let o=n;return o})();var di=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=$({type:n}),n.\u0275inj=j({imports:[Ce,Fe,Me,ye]});let o=n;return o})();export{di as AdminModule};
